<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Head content remains the same -->
</head>
<body class="flex flex-col min-h-screen bg-gray-50 text-gray-900">
    <!-- Header and main translation section remain the same -->

    <section class="bg-gray-100 py-8">
        <div class="container mx-auto px-4 md:px-6">
            <h2 class="text-2xl font-bold">Translation History</h2>
            <div id="translationHistory" class="mt-6 grid gap-4">
                <!-- Translation history items will be dynamically inserted here -->
            </div>
        </div>
    </section>

    <!-- Footer remains the same -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/sanscript/1.1.2/sanscript.min.js"></script>
    <script>
        // Existing JavaScript code...

        // New functions for handling translation history
        function saveTranslation(sourceText, targetText, sourceLang, targetLang) {
            let history = JSON.parse(localStorage.getItem('translationHistory') || '[]');
            history.unshift({ sourceText, targetText, sourceLang, targetLang, timestamp: new Date().toISOString() });
            history = history.slice(0, 10); // Keep only the last 10 translations
            localStorage.setItem('translationHistory', JSON.stringify(history));
            displayTranslationHistory();
        }

        function displayTranslationHistory() {
            const history = JSON.parse(localStorage.getItem('translationHistory') || '[]');
            const historyContainer = document.getElementById('translationHistory');
            historyContainer.innerHTML = '';

            history.forEach((item, index) => {
                const historyItem = document.createElement('div');
                historyItem.className = 'rounded-lg border bg-white p-4';
                historyItem.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium">${item.sourceText}</p>
                            <p class="text-sm text-gray-500">${item.targetText}</p>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="copyTranslation(${index})" class="p-1 hover:bg-gray-100 rounded">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <rect width="14" height="14" x="8" y="8" rx="2" ry="2" />
                                    <path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2" />
                                </svg>
                            </button>
                            <button onclick="deleteTranslation(${index})" class="p-1 hover:bg-gray-100 rounded">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M3 6h18" />
                                    <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" />
                                    <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" />
                                </svg>
                            </button>
                        </div>
                    </div>
                `;
                historyContainer.appendChild(historyItem);
            });
        }

        function copyTranslation(index) {
            const history = JSON.parse(localStorage.getItem('translationHistory') || '[]');
            const text = history[index].targetText;
            navigator.clipboard.writeText(text).then(() => {
                alert('Translation copied to clipboard!');
            });
        }

        function deleteTranslation(index) {
            let history = JSON.parse(localStorage.getItem('translationHistory') || '[]');
            history.splice(index, 1);
            localStorage.setItem('translationHistory', JSON.stringify(history));
            displayTranslationHistory();
        }

        // Modify the performTranslation function to save translations
        async function performTranslation() {
            // Existing translation code...

            try {
                const response = await fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${sourceLanguage.value}|${targetLanguage.value}`);
                const data = await response.json();
                targetText.value = data.responseData.translatedText;

                // Save the translation to history
                saveTranslation(text, data.responseData.translatedText, sourceLanguage.value, targetLanguage.value);

                // Existing code for transliteration and Google Analytics...
            } catch (error) {
                // Error handling...
            } finally {
                // Reset button state...
            }
        }

        // Display translation history on page load
        displayTranslationHistory();

        // Rest of your existing code...
    </script>
</body>
</html>
